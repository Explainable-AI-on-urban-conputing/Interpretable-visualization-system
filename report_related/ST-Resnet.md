# ST-Resnet

The ST-Resnet(Deep Spatio-Temporal Residual Networks) is designed to solve the flow prediction problem that we defined above which can help excavate spatial dependencies,  temporal dependencies and external influence in the spatio-temporal series data. Figure 3 presents the architecture of ST-ResNet, which
is comprised of four major components modeling temporal closeness, period, trend, and external influence, respectively. As illustrated in the top-right part of Figure 3, we first turn Inflow and outflow throughout a city at each time interval into a 2-channel image-like matrix respectively, using the approach introduced in we defined in part  1.1. We then divide the time axis into three fragments, denoting recent time, near history and distant history. The 2-channel flow matrices of intervals in each time fragment are then fed into the first three components separately to model the aforementioned three temporal properties: closeness, period and trend, respectively. The first three components share the same network structure with a convolutional neural network followed by a Residual Unit sequence. Such structure captures the spatial dependency between nearby and distant regions. In the external component, we manually extract some features from external datasets, such as weather conditions and events, feeding them into a two-layer fully-connected neural network. The outputs of the first three components are fused as XRes based on parameter matrices, which assign different weights to the results of different components in different regions. XRes is further integrated with the output of the external component XExt. Finally, the aggregation is mapped into [âˆ’1, 1] by a Tanh function, which yields a faster convergence than the standard logistic function in the process of back-propagation learning. As the classical model in the flow prediction area, the ST-Resnet has a good result in prediction the future flow.

